(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     35669,        825]
NotebookOptionsPosition[     34724,        788]
NotebookOutlinePosition[     35068,        803]
CellTagsIndexPosition[     35025,        800]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[" B - spline surfaces", "Subtitle",
 CellChangeTimes->{{3.4991094606434994`*^9, 3.499109474090723*^9}, 
   3.636033161614891*^9},
 FontFamily->"Arial"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.636033837840099*^9, 3.6360338404765034`*^9}}],

Cell[TextData[{
 "\t",
 StyleBox["x",
  FontWeight->"Bold"],
 "(u,v) = ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {
       RowBox[{
        SubsuperscriptBox["N", "0", "nu"], "(", "u", ")"}], "...", 
       RowBox[{
        SubsuperscriptBox["N", 
         RowBox[{"nu", "+", "llu"}], "nu"], "(", "u", ")"}]}
     }]}], TraditionalForm]]],
 ")  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {
       SubscriptBox[
        StyleBox["d",
         FontWeight->"Bold"], "11"], "...", 
       SubscriptBox[
        StyleBox["d",
         FontWeight->"Bold"], 
        RowBox[{"1", ",", 
         RowBox[{"llv", "+", "nv"}]}]]},
      {"\[VerticalEllipsis]", "\[Placeholder]", "\[VerticalEllipsis]"},
      {
       SubscriptBox[
        StyleBox["d",
         FontWeight->"Bold"], 
        RowBox[{
         RowBox[{"llu", "+", "nu"}], ",", "1"}]], "...", 
       SubscriptBox["d", 
        RowBox[{
         RowBox[{"llu", "+", "nu"}], ",", 
         RowBox[{"llv", "+", "nv"}]}]]}
     }], ")"}], TraditionalForm]]],
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {
       RowBox[{
        SubsuperscriptBox["N", "0", "nv"], "(", "v", ")"}]},
      {"\[VerticalEllipsis]"},
      {
       RowBox[{
        SubsuperscriptBox["N", 
         RowBox[{"llv", "+", "nv"}], "nv"], "(", "v", ")"}]}
     }], ")"}], TraditionalForm]]],
 "\n\n\tD: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"\[Placeholder]", 
       RowBox[{"v", "\[LongRightArrow]"}]},
      {
       RowBox[{"\[DownArrow]", "u"}], "\[Placeholder]"}
     }], ")"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\n \n"
}], "Text",
 CellChangeTimes->{{3.499109692210306*^9, 3.4991098565877953`*^9}, {
   3.49910993313713*^9, 3.499109950952361*^9}, {3.49910999634844*^9, 
   3.4991100964850163`*^9}, {3.4991101465299044`*^9, 3.499110163721134*^9}, {
   3.499110345274253*^9, 3.499110423399191*^9}, {3.4991105995859003`*^9, 
   3.4991106596304054`*^9}, {3.499520076193455*^9, 3.4995200792977557`*^9}, {
   3.4995201666393566`*^9, 3.499520184578781*^9}, {3.499520236228726*^9, 
   3.4995202531073847`*^9}, {3.499520450791504*^9, 3.4995204606546736`*^9}, {
   3.499520501426734*^9, 3.499520558739314*^9}, {3.4995207457477803`*^9, 
   3.4995207701682544`*^9}, {3.4995208420729837`*^9, 3.499520853525996*^9}, {
   3.5288111268322735`*^9, 3.5288111331974816`*^9}, {3.5288124730056753`*^9, 
   3.528812526077896*^9}, 3.529097327259808*^9, 3.5290973799411*^9, {
   3.529097454696432*^9, 3.529097465959652*^9}, {3.5290975302941647`*^9, 
   3.5290975353173733`*^9}, {3.529157704488058*^9, 3.529157812471448*^9}, {
   3.5291578502079134`*^9, 3.5291579264920473`*^9}, {3.5291609789726095`*^9, 
   3.5291610059918575`*^9}, {3.529161061746355*^9, 3.5291610697647696`*^9}, {
   3.529161348147258*^9, 3.529161350939663*^9}, {3.52916186146816*^9, 
   3.529161864790966*^9}, {3.5291620858277545`*^9, 3.529162088308159*^9}, 
   3.529166472114661*^9, {3.5292750027825737`*^9, 3.529275016884999*^9}, 
   3.5292752497622075`*^9, {3.5292755292210984`*^9, 3.529275558159149*^9}, 
   3.5292758587560773`*^9, {3.5292759405314207`*^9, 3.5292760216827636`*^9}, {
   3.529276456439927*^9, 3.5292764642399406`*^9}, {3.562965121782059*^9, 
   3.5629651422495213`*^9}, {3.5629657982743444`*^9, 
   3.5629658030168962`*^9}, {3.5629665077583203`*^9, 3.562966511471168*^9}, {
   3.5630374115775447`*^9, 3.563037413590177*^9}, 3.563037449536724*^9, 
   3.563052035161214*^9, 3.563052192567232*^9, 3.5630522634701414`*^9, 
   3.56305229613696*^9, {3.563052345885998*^9, 3.5630523489748373`*^9}, 
   3.5630524280834513`*^9, 3.563052492309475*^9, {3.5630525305143647`*^9, 
   3.563052555646287*^9}, {3.5630526578119965`*^9, 3.5630526732873955`*^9}, 
   3.563052717638764*^9, {3.563052766217787*^9, 3.563052787090854*^9}, 
   3.5630528200616875`*^9, {3.5630528694987216`*^9, 3.563052913460085*^9}, {
   3.563052950198556*^9, 3.5630529707596197`*^9}, {3.563055893027895*^9, 
   3.563055934337225*^9}, {3.563056014225849*^9, 3.563056028515632*^9}, 
   3.5630561003857536`*^9, {3.563056180835985*^9, 3.563056206498314*^9}, {
   3.5630562634702444`*^9, 3.563056267479496*^9}, {3.563056400315199*^9, 
   3.5630564627939997`*^9}, {3.563056506708563*^9, 3.563056549031905*^9}, {
   3.5630565930244694`*^9, 3.5630566350826087`*^9}, 3.5630566743171115`*^9, {
   3.5630586257073455`*^9, 3.5630586276573706`*^9}, {3.5630586799336405`*^9, 
   3.5630586874997377`*^9}, {3.5630587236142006`*^9, 
   3.5630587464060926`*^9}, {3.563058781834147*^9, 3.563058800320384*^9}, {
   3.563058834968428*^9, 3.5630588387436767`*^9}, {3.5630589052629294`*^9, 
   3.563058907088153*^9}, 3.5630682342433696`*^9, 3.563115896901076*^9, 
   3.563201476257924*^9, 3.563203376087471*^9, {3.5632034190977736`*^9, 
   3.5632034225610623`*^9}, 3.5702267012660904`*^9, {3.6360329675505505`*^9, 
   3.636033012182229*^9}, {3.6360332569622583`*^9, 3.6360332893479156`*^9}, {
   3.6360337175638876`*^9, 3.636033867402151*^9}, {3.6360339017066107`*^9, 
   3.636034054243679*^9}, {3.636034173318688*^9, 3.6360341780454965`*^9}, {
   3.636034320005746*^9, 3.636034353701805*^9}, {3.63603438508906*^9, 
   3.6360343944646764`*^9}, {3.636034814729415*^9, 3.636034952118856*^9}},
 FontSize->18],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nu", "=", "3"}], ";", "  ", 
   RowBox[{"(*", 
    RowBox[{"u", "-", "degree"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"nv", "=", "3"}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{"v", "-", "degree"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"llu", "=", "3"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"number", " ", "of", " ", "u"}], "-", 
    RowBox[{"domain", " ", "intervals"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"llv", "=", "5"}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"number", " ", "of", " ", "v"}], "-", 
    RowBox[{"domain", " ", "intervals"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"u", ",", 
    RowBox[{"v", "-", " ", 
     RowBox[{"knot", " ", 
      RowBox[{"sequences", ":"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"knotu", " ", "=", " ", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "nu"}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"i", "/", "llu"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"llu", "-", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "nu"}], "}"}]}], "]"}]}], "]"}], "//", 
    "N"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"knotv", " ", "=", " ", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "nv"}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"i", "/", "llv"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"llv", "-", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "nv"}], "}"}]}], "]"}]}], "]"}], "//", 
    "N"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"B", "-", 
    RowBox[{"spline", " ", "control", " ", 
     RowBox[{"grid", ":"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Sqrt", "[", "i", "]"}], "*", 
          RowBox[{"Cos", "[", "j", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Sqrt", "[", "i", "]"}], "*", 
          RowBox[{"Sin", "[", "j", "]"}]}], ",", 
         RowBox[{".5", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"j", "^", "2"}], "+", 
             RowBox[{"i", "^", "2"}]}], ")"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"nu", "+", "llu"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"nv", "+", "llv"}]}], "}"}]}], "]"}], "//", "N"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"netplot", "=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PointSize", "[", "Medium", "]"}], ",", "Red", ",", 
      RowBox[{"Map", "[", 
       RowBox[{"Point", ",", "dd"}], "]"}], ",", "Gray", ",", 
      RowBox[{"Line", "[", "dd", "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"Transpose", "[", "dd", "]"}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"surfplot", "=", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"BSplineSurface", "[", 
      RowBox[{"dd", ",", 
       RowBox[{"SplineKnots", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"knotu", ",", "knotv"}], "}"}]}], ",", 
       RowBox[{"SplineDegree", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{"nu", ",", "nv"}], "}"}]}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"surfplot", ",", "netplot"}], "}"}], ",", 
    RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.499109692210306*^9, 3.4991098565877953`*^9}, {
   3.49910993313713*^9, 3.499109950952361*^9}, {3.49910999634844*^9, 
   3.4991100964850163`*^9}, {3.4991101465299044`*^9, 3.499110163721134*^9}, {
   3.499110345274253*^9, 3.499110423399191*^9}, {3.4991105995859003`*^9, 
   3.4991106596304054`*^9}, {3.499520076193455*^9, 3.4995200792977557`*^9}, {
   3.4995201666393566`*^9, 3.499520184578781*^9}, {3.499520236228726*^9, 
   3.4995202531073847`*^9}, {3.499520450791504*^9, 3.4995204606546736`*^9}, {
   3.499520501426734*^9, 3.499520558739314*^9}, {3.4995207457477803`*^9, 
   3.4995207701682544`*^9}, {3.4995208420729837`*^9, 3.499520853525996*^9}, {
   3.5288111268322735`*^9, 3.5288111331974816`*^9}, {3.5288124730056753`*^9, 
   3.528812526077896*^9}, 3.529097327259808*^9, 3.5290973799411*^9, {
   3.529097454696432*^9, 3.529097465959652*^9}, {3.5290975302941647`*^9, 
   3.5290975353173733`*^9}, {3.529157704488058*^9, 3.529157812471448*^9}, {
   3.5291578502079134`*^9, 3.5291579264920473`*^9}, {3.5291609789726095`*^9, 
   3.5291610059918575`*^9}, {3.529161061746355*^9, 3.5291610697647696`*^9}, {
   3.529161348147258*^9, 3.529161350939663*^9}, {3.52916186146816*^9, 
   3.529161864790966*^9}, {3.5291620858277545`*^9, 3.529162088308159*^9}, 
   3.529166472114661*^9, {3.5292750027825737`*^9, 3.529275016884999*^9}, 
   3.5292752497622075`*^9, {3.5292755292210984`*^9, 3.529275558159149*^9}, 
   3.5292758587560773`*^9, {3.5292759405314207`*^9, 3.5292760216827636`*^9}, {
   3.529276456439927*^9, 3.5292764642399406`*^9}, {3.562965121782059*^9, 
   3.5629651422495213`*^9}, {3.5629657982743444`*^9, 
   3.5629658030168962`*^9}, {3.5629665077583203`*^9, 3.562966511471168*^9}, {
   3.5630374115775447`*^9, 3.563037413590177*^9}, 3.563037449536724*^9, 
   3.563052035161214*^9, 3.563052192567232*^9, 3.5630522634701414`*^9, 
   3.56305229613696*^9, {3.563052345885998*^9, 3.5630523489748373`*^9}, 
   3.5630524280834513`*^9, 3.563052492309475*^9, {3.5630525305143647`*^9, 
   3.563052555646287*^9}, {3.5630526578119965`*^9, 3.5630526732873955`*^9}, 
   3.563052717638764*^9, {3.563052766217787*^9, 3.563052787090854*^9}, 
   3.5630528200616875`*^9, {3.5630528694987216`*^9, 3.563052913460085*^9}, {
   3.563052950198556*^9, 3.5630529707596197`*^9}, {3.563055893027895*^9, 
   3.563055934337225*^9}, {3.563056014225849*^9, 3.563056028515632*^9}, 
   3.5630561003857536`*^9, {3.563056180835985*^9, 3.563056206498314*^9}, {
   3.5630562634702444`*^9, 3.563056267479496*^9}, {3.563056400315199*^9, 
   3.5630564627939997`*^9}, {3.563056506708563*^9, 3.563056549031905*^9}, {
   3.5630565930244694`*^9, 3.5630566350826087`*^9}, 3.5630566743171115`*^9, {
   3.5630586257073455`*^9, 3.5630586276573706`*^9}, {3.5630586799336405`*^9, 
   3.5630586874997377`*^9}, {3.5630587236142006`*^9, 
   3.5630587464060926`*^9}, {3.563058781834147*^9, 3.563058800320384*^9}, {
   3.563058834968428*^9, 3.5630588387436767`*^9}, {3.5630589052629294`*^9, 
   3.563058907088153*^9}, 3.5630682342433696`*^9, 3.563115896901076*^9, 
   3.563201476257924*^9, 3.563203376087471*^9, {3.5632034190977736`*^9, 
   3.5632034225610623`*^9}, 3.5702267012660904`*^9, {3.6360329675505505`*^9, 
   3.636033012182229*^9}, {3.6360332569622583`*^9, 3.636033275526291*^9}, {
   3.636035140645187*^9, 3.6360351436403923`*^9}, {3.636035184512464*^9, 
   3.6360351874920692`*^9}, {3.6360352811702337`*^9, 3.6360352856630416`*^9}, 
   3.636035692293356*^9, 3.6360357255370145`*^9},
 FontFamily->"Courier New",
 FontSize->18],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.3333333333333333`", ",", 
   "0.6666666666666666`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6360352871606445`*^9, 3.6360356943213596`*^9, 
  3.636035727128217*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.2`", ",", "0.4`", ",", 
   "0.6`", ",", "0.8`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6360352871606445`*^9, 3.6360356943213596`*^9, 
  3.636035727128217*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Isoparametric curve moving on a surface\
\>", "Subtitle",
 CellChangeTimes->{{3.562965048570321*^9, 3.5629651158695836`*^9}, {
   3.5629651638245983`*^9, 3.562965238315553*^9}, {3.562965334677989*^9, 
   3.5629653973595924`*^9}, {3.562965439246129*^9, 3.5629654891355686`*^9}, {
   3.562965558619464*^9, 3.5629656902096815`*^9}, 3.562965770240246*^9, {
   3.5629658292569113`*^9, 3.562965858913082*^9}, {3.562966177268083*^9, 
   3.562966178360097*^9}, {3.5629664068094263`*^9, 3.5629664920957193`*^9}, {
   3.5630237809720645`*^9, 3.5630237838425016`*^9}, {3.5630363294504414`*^9, 
   3.5630363541455584`*^9}, {3.5630364164059563`*^9, 
   3.5630365180568595`*^9}, {3.5630365590073843`*^9, 3.563036647023713*^9}, {
   3.5630367140889726`*^9, 3.563036799749671*^9}, {3.5630369898537083`*^9, 
   3.5630369917569323`*^9}, {3.563037124795438*^9, 3.5630371352787724`*^9}, {
   3.563037243577362*^9, 3.563037281895383*^9}, {3.5630373179199395`*^9, 
   3.5630373505433035`*^9}, 3.5630373896414137`*^9, {3.563037564378992*^9, 
   3.563037591773997*^9}, {3.5630376311972184`*^9, 3.5630376343641806`*^9}, 
   3.563037679824912*^9, 3.5630377322904024`*^9, {3.5630452114452066`*^9, 
   3.5630452168428755`*^9}, {3.5630452923010435`*^9, 
   3.5630453298195243`*^9}, {3.5630453800833683`*^9, 
   3.5630453829694057`*^9}, {3.563051809894326*^9, 3.5630518832464666`*^9}, {
   3.5630519563958044`*^9, 3.5630520071588554`*^9}, {3.56305206135395*^9, 
   3.563052116048251*^9}, {3.563052161756837*^9, 3.5630521747362037`*^9}, {
   3.563052392171791*^9, 3.563052395291831*^9}, {3.5630524393935966`*^9, 
   3.5630524404856105`*^9}, 3.5630524715612087`*^9, {3.563052565568014*^9, 
   3.5630525901227293`*^9}, {3.5630588540942736`*^9, 3.563058877744177*^9}, {
   3.563115929928604*^9, 3.5631159687757597`*^9}},
 FontFamily->"Arial",
 FontSize->18,
 FontWeight->"Bold"],

Cell[TextData[{
 "Column",
 StyleBox[" j",
  FontSlant->"Italic"],
 " of ",
 StyleBox["dd ",
  FontSlant->"Italic"],
 "is given by ",
 StyleBox["dd[[j]]",
  FontSlant->"Italic"],
 ". It has",
 StyleBox[" nu",
  FontSlant->"Italic"],
 " + ",
 StyleBox["llu",
  FontSlant->"Italic"],
 " elements.\nWe need ",
 StyleBox["dd[[i]]",
  FontSlant->"Italic"],
 " evaluated at the moving value ",
 StyleBox["v",
  FontSlant->"Italic"],
 ". All those values (points) are stored in the array ",
 StyleBox["cc",
  FontSlant->"Italic"],
 ", which has ",
 StyleBox["nu + llu",
  FontSlant->"Italic"],
 " elements. Its variable is ",
 StyleBox["u.",
  FontSlant->"Italic"],
 " "
}], "Text",
 CellChangeTimes->{{3.562965048570321*^9, 3.5629651158695836`*^9}, {
   3.5629651638245983`*^9, 3.562965238315553*^9}, {3.562965334677989*^9, 
   3.5629653973595924`*^9}, {3.562965439246129*^9, 3.5629654891355686`*^9}, {
   3.562965558619464*^9, 3.5629656902096815`*^9}, 3.562965770240246*^9, {
   3.5629658292569113`*^9, 3.562965858913082*^9}, {3.562966177268083*^9, 
   3.562966178360097*^9}, {3.5629664068094263`*^9, 3.5629664920957193`*^9}, {
   3.5630237809720645`*^9, 3.5630237838425016`*^9}, {3.5630363294504414`*^9, 
   3.5630363541455584`*^9}, {3.5630364164059563`*^9, 
   3.5630365180568595`*^9}, {3.5630365590073843`*^9, 3.563036647023713*^9}, {
   3.5630367140889726`*^9, 3.563036799749671*^9}, {3.5630369898537083`*^9, 
   3.5630369917569323`*^9}, {3.563037124795438*^9, 3.5630371352787724`*^9}, {
   3.563037243577362*^9, 3.563037281895383*^9}, {3.5630373179199395`*^9, 
   3.5630373505433035`*^9}, 3.5630373896414137`*^9, {3.563037564378992*^9, 
   3.563037591773997*^9}, {3.5630376311972184`*^9, 3.5630376343641806`*^9}, 
   3.563037679824912*^9, 3.5630377322904024`*^9, {3.5630452114452066`*^9, 
   3.5630452168428755`*^9}, {3.5630452923010435`*^9, 
   3.5630453298195243`*^9}, {3.5630453800833683`*^9, 
   3.5630453829694057`*^9}, {3.563051809894326*^9, 3.5630518832464666`*^9}, {
   3.5630519563958044`*^9, 3.5630520071588554`*^9}, {3.56305206135395*^9, 
   3.563052116048251*^9}, {3.563052161756837*^9, 3.5630521747362037`*^9}, {
   3.563052392171791*^9, 3.563052395291831*^9}, {3.5630524393935966`*^9, 
   3.5630524404856105`*^9}, 3.5630524715612087`*^9, {3.563052565568014*^9, 
   3.5630525901227293`*^9}, {3.5630588540942736`*^9, 3.563058877744177*^9}, {
   3.563115929928604*^9, 3.563115951380117*^9}, {3.56311603191503*^9, 
   3.563116035784202*^9}, {3.5631436051121583`*^9, 3.563143606875004*^9}, {
   3.5632014854920588`*^9, 3.5632015405069103`*^9}, {3.5632016124150996`*^9, 
   3.5632016225081053`*^9}, {3.636032291570163*^9, 3.6360323327542353`*^9}, {
   3.636032373735507*^9, 3.6360324056843634`*^9}, {3.636032550546218*^9, 
   3.636032560935836*^9}, {3.6360327063280916`*^9, 3.6360327274661283`*^9}, 
   3.6360328174002867`*^9, {3.636034425602331*^9, 3.6360344309687405`*^9}, {
   3.63603453874933*^9, 3.6360345420409355`*^9}, {3.636034729646865*^9, 
   3.636034729865266*^9}},
 FontSize->18],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cv", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"nu", "+", "llu"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"cv", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"BSplineBasis", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"nv", ",", "knotv"}], "}"}], ",", 
              RowBox[{"j", "-", "1"}], ",", "v"}], "]"}], "*", 
            RowBox[{"dd", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"nv", "+", "llv"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"nu", "+", "llu"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"points", "=", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{"{", 
         RowBox[{"Black", ",", 
          RowBox[{"PointSize", "[", "0.025", "]"}], ",", 
          RowBox[{"Point", "[", "cv", "]"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cvplot", "=", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{"Line", "[", "cv", "]"}], "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"curve", "=", " ", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{"{", 
         RowBox[{"Green", ",", "Thick", ",", 
          RowBox[{"BSplineCurve", "[", 
           RowBox[{"cv", ",", 
            RowBox[{"SplineDegree", "\[Rule]", "nu"}], ",", 
            RowBox[{"SplineKnots", "\[Rule]", "knotu"}]}], "]"}]}], "}"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
       "surfplot", ",", "points", ",", "curve", ",", "cvplot", ",", "netplot",
         ",", 
        RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"v", ",", "0", ",", "1"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.562965048570321*^9, 3.5629651158695836`*^9}, {
   3.5629651638245983`*^9, 3.562965238315553*^9}, {3.562965334677989*^9, 
   3.5629653973595924`*^9}, {3.562965439246129*^9, 3.5629654891355686`*^9}, {
   3.562965558619464*^9, 3.5629656902096815`*^9}, 3.562965770240246*^9, {
   3.5629658292569113`*^9, 3.562965858913082*^9}, {3.562966177268083*^9, 
   3.562966178360097*^9}, {3.5629664068094263`*^9, 3.5629664920957193`*^9}, {
   3.5630237809720645`*^9, 3.5630237838425016`*^9}, {3.5630363294504414`*^9, 
   3.5630363541455584`*^9}, {3.5630364164059563`*^9, 
   3.5630365180568595`*^9}, {3.5630365590073843`*^9, 3.563036647023713*^9}, {
   3.5630367140889726`*^9, 3.563036799749671*^9}, {3.5630369898537083`*^9, 
   3.5630369917569323`*^9}, {3.563037124795438*^9, 3.5630371352787724`*^9}, {
   3.563037243577362*^9, 3.563037281895383*^9}, {3.5630373179199395`*^9, 
   3.5630373505433035`*^9}, 3.5630373896414137`*^9, {3.563037564378992*^9, 
   3.563037591773997*^9}, {3.5630376311972184`*^9, 3.5630376343641806`*^9}, 
   3.563037679824912*^9, 3.5630377322904024`*^9, {3.5630452114452066`*^9, 
   3.5630452168428755`*^9}, {3.5630452923010435`*^9, 
   3.5630453298195243`*^9}, {3.5630453800833683`*^9, 
   3.5630453829694057`*^9}, {3.563051809894326*^9, 3.5630518832464666`*^9}, {
   3.5630519563958044`*^9, 3.5630520071588554`*^9}, {3.56305206135395*^9, 
   3.563052116048251*^9}, {3.563052161756837*^9, 3.5630521747362037`*^9}, {
   3.563052392171791*^9, 3.563052395291831*^9}, {3.5630524393935966`*^9, 
   3.5630524404856105`*^9}, 3.5630524715612087`*^9, {3.563052565568014*^9, 
   3.5630525901227293`*^9}, {3.5630588540942736`*^9, 3.563058877744177*^9}, {
   3.563115929928604*^9, 3.563115951380117*^9}, {3.56311603191503*^9, 
   3.563116035784202*^9}, {3.5631436051121583`*^9, 3.563143606875004*^9}, {
   3.5632014854920588`*^9, 3.5632015405069103`*^9}, {3.5632016124150996`*^9, 
   3.5632016225081053`*^9}, 3.636032291570163*^9, {3.636035029978593*^9, 
   3.6360351208019524`*^9}, {3.6360353658003826`*^9, 3.636035368467987*^9}, {
   3.636035537962285*^9, 3.636035585401968*^9}, 3.6360356389412622`*^9},
 FontFamily->"Courier New",
 FontSize->18],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`v$$ = 0, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`v$$], 0, 1}}, Typeset`size$$ = {376., {189., 194.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`v$14480$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`v$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`v$$, $CellContext`v$14480$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> (
       Do[Part[$CellContext`cv, $CellContext`i] = 
         Sum[BSplineBasis[{$CellContext`nv, $CellContext`knotv}, \
$CellContext`j - 1, $CellContext`v$$] 
           Part[$CellContext`dd, $CellContext`i, $CellContext`j], \
{$CellContext`j, 1, $CellContext`nv + $CellContext`llv}], {$CellContext`i, 
          1, $CellContext`nu + $CellContext`llu}]; $CellContext`points = 
        Graphics3D[{Black, 
           PointSize[0.025], 
           Point[$CellContext`cv]}]; $CellContext`cvplot = Graphics3D[
          Line[$CellContext`cv]]; $CellContext`curve = 
        Graphics3D[{Green, Thick, 
           
           BSplineCurve[$CellContext`cv, SplineDegree -> $CellContext`nu, 
            SplineKnots -> $CellContext`knotu]}]; 
       Show[$CellContext`surfplot, $CellContext`points, $CellContext`curve, \
$CellContext`cvplot, $CellContext`netplot, Boxed -> False]), 
      "Specifications" :> {{$CellContext`v$$, 0, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{427., {236., 241.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.5629656938913994`*^9, 3.5629657875099993`*^9, {3.56296581841459*^9, 
   3.562965861970741*^9}, 3.562966180341323*^9, {3.5629664972125854`*^9, 
   3.5629665169156375`*^9}, 3.5630237851061172`*^9, 3.5630362547410836`*^9, {
   3.563036436421013*^9, 3.563036478167148*^9}, 3.5630365203968897`*^9, 
   3.563037149646557*^9, 3.563037248772762*^9, 3.5630372829563055`*^9, {
   3.563037325424405*^9, 3.563037352602741*^9}, {3.5630373911547885`*^9, 
   3.5630374189259925`*^9}, 3.563037455559019*^9, {3.563037568357196*^9, 
   3.563037593692895*^9}, 3.563037635596644*^9, 3.563037680776561*^9, 
   3.563037734349708*^9, 3.5630453321439543`*^9, 3.5630519040415335`*^9, {
   3.56305195839263*^9, 3.5630520086252737`*^9}, 3.5630520432265177`*^9, {
   3.563052082944627*^9, 3.563052117031064*^9}, {3.563052175329011*^9, 
   3.563052199259718*^9}, 3.563052268774209*^9, 3.5630523051694756`*^9, 
   3.5630523583661575`*^9, 3.5630523961030416`*^9, {3.5630524440736566`*^9, 
   3.563052499391966*^9}, {3.563052570872082*^9, 3.56305259177635*^9}, 
   3.563052725594866*^9, 3.563052797059382*^9, {3.56305285377372*^9, 
   3.5630529240838213`*^9}, 3.5630529806345463`*^9, 3.563056110775487*^9, 
   3.5630562181048627`*^9, 3.5630562797256527`*^9, 3.5630564263675327`*^9, 
   3.5630564815610404`*^9, {3.563056533852911*^9, 3.5630565596400414`*^9}, {
   3.5630566553784685`*^9, 3.563056679870783*^9}, 3.5630587569206276`*^9, 
   3.563058813642955*^9, {3.5630588716600986`*^9, 3.563058886839093*^9}, 
   3.5630589175870876`*^9, 3.563068195679675*^9, 3.563068248735955*^9, 
   3.563115904608019*^9, 3.563116037796796*^9, {3.563143594332282*^9, 
   3.5631436082010374`*^9}, 3.5632014606753225`*^9, 3.5632033833728576`*^9, 
   3.5632034269291744`*^9, 3.5702266841214705`*^9, 3.6360321324342833`*^9, {
   3.6360351005687165`*^9, 3.636035152516808*^9}, 3.6360355411446905`*^9, 
   3.636035589145975*^9, 3.6360356415932665`*^9, 3.6360356995005684`*^9, 
   3.636035732697427*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Comb moving on a surface",
 FontSize->18,
 FontWeight->"Bold"]], "Subtitle",
 CellChangeTimes->{{3.636035872333272*^9, 3.6360359032525263`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cv", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"nu", "+", "llu"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"cv", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"BSplineBasis", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"nv", ",", "knotv"}], "}"}], ",", 
            RowBox[{"j", "-", "1"}], ",", "v"}], "]"}], "*", 
          RowBox[{"dd", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"nv", "+", "llv"}]}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"nu", "+", "llu"}]}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"isov", "[", "u_", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"BSplineBasis", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"nu", ",", "knotu"}], "}"}], ",", 
          RowBox[{"i", "-", "1"}], ",", "u"}], "]"}], "*", 
        RowBox[{"cv", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"nu", "+", "llu"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"points", "=", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"{", 
       RowBox[{"Black", ",", 
        RowBox[{"PointSize", "[", "0.025", "]"}], ",", 
        RowBox[{"Point", "[", "cv", "]"}]}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"cvplot", "=", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"Line", "[", "cv", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"curve", "=", " ", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "Thick", ",", 
        RowBox[{"BSplineCurve", "[", 
         RowBox[{"cv", ",", 
          RowBox[{"SplineDegree", "\[Rule]", "nu"}], ",", 
          RowBox[{"SplineKnots", "\[Rule]", "knotu"}]}], "]"}]}], "}"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{
     "surfplot", ",", "points", ",", "curve", ",", "cvplot", ",", "netplot", 
      ",", 
      RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"v", ",", "0", ",", "1"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.63603599042548*^9, 3.636035992547083*^9}, {
   3.6360360974104676`*^9, 3.636036098206069*^9}, {3.636036156690572*^9, 
   3.6360361833510184`*^9}, {3.6360362437231245`*^9, 
   3.6360362479819317`*^9}, {3.636036387680177*^9, 3.636036450891488*^9}, {
   3.6360365039939814`*^9, 3.6360365392188435`*^9}, 3.6360365819005184`*^9, 
   3.636036635081012*^9},
 FontFamily->"Courier New",
 FontSize->18],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`v$$ = 0.28, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`v$$], 0, 1}}, Typeset`size$$ = {360., {186., 189.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`v$14598$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`v$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`v$$, $CellContext`v$14598$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> (
       Do[Part[$CellContext`cv, $CellContext`i] = 
         Sum[BSplineBasis[{$CellContext`nv, $CellContext`knotv}, \
$CellContext`j - 1, $CellContext`v$$] 
           Part[$CellContext`dd, $CellContext`i, $CellContext`j], \
{$CellContext`j, 1, $CellContext`nv + $CellContext`llv}], {$CellContext`i, 
          1, $CellContext`nu + $CellContext`llu}]; $CellContext`isov[
          Pattern[$CellContext`u, 
           Blank[]]] := 
        Sum[BSplineBasis[{$CellContext`nu, $CellContext`knotu}, \
$CellContext`i - 1, $CellContext`u] 
          Part[$CellContext`cv, $CellContext`i], {$CellContext`i, 
           1, $CellContext`nu + $CellContext`llu}]; $CellContext`points = 
        Graphics3D[{Black, 
           PointSize[0.025], 
           Point[$CellContext`cv]}]; $CellContext`cvplot = Graphics3D[
          Line[$CellContext`cv]]; $CellContext`curve = 
        Graphics3D[{Green, Thick, 
           
           BSplineCurve[$CellContext`cv, SplineDegree -> $CellContext`nu, 
            SplineKnots -> $CellContext`knotu]}]; 
       Show[$CellContext`surfplot, $CellContext`points, $CellContext`curve, \
$CellContext`cvplot, $CellContext`netplot, Boxed -> False]), 
      "Specifications" :> {{$CellContext`v$$, 0, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{411., {232., 237.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.6360366718502765`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1008, 633},
WindowMargins->{{Automatic, 71}, {0, Automatic}},
FrontEndVersion->"9.0 for Microsoft Windows (32-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 156, 3, 49, "Subtitle"],
Cell[726, 27, 94, 1, 31, "Input"],
Cell[823, 30, 5233, 112, 208, "Text"],
Cell[CellGroupData[{
Cell[6081, 146, 7858, 179, 577, "Input"],
Cell[13942, 327, 308, 7, 31, "Output"],
Cell[14253, 336, 304, 7, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14606, 349, 1855, 30, 65, "Subtitle"],
Cell[16464, 381, 2999, 65, 86, "Text"],
Cell[CellGroupData[{
Cell[19488, 450, 4698, 98, 469, "Input"],
Cell[24189, 550, 4269, 75, 494, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28507, 631, 168, 3, 49, "Subtitle"],
Cell[CellGroupData[{
Cell[28700, 638, 3349, 90, 496, "Input"],
Cell[32052, 730, 2644, 54, 486, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
